var Jr=Object.defineProperty;var i=(e,r)=>Jr(e,"name",{value:r,configurable:!0});import{g as Gr,f as Te}from"./client-BwFGbomL.js";import"./index-pNxa2EbX.js";var Kr=Object.defineProperty,Xr=i((e,r,t)=>r in e?Kr(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,"Kt"),v=i((e,r,t)=>(Xr(e,typeof r!="symbol"?r+"":r,t),t),"p"),k=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function mr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}i(mr,"lt");var Yr=Array.isArray,E=Yr,Zr=typeof k=="object"&&k&&k.Object===Object&&k,jr=Zr,et=jr,rt=typeof self=="object"&&self&&self.Object===Object&&self,tt=et||rt||Function("return this")(),O=tt,nt=O,at=nt.Symbol,R=at,Ie=R,_r=Object.prototype,ot=_r.hasOwnProperty,it=_r.toString,z=Ie?Ie.toStringTag:void 0;function st(e){var r=ot.call(e,z),t=e[z];try{e[z]=void 0;var n=!0}catch{}var a=it.call(e);return n&&(r?e[z]=t:delete e[z]),a}i(st,"Zt");var ct=st,ut=Object.prototype,lt=ut.toString;function ft(e){return lt.call(e)}i(ft,"rr");var dt=ft,Pe=R,ht=ct,pt=dt,yt="[object Null]",bt="[object Undefined]",ze=Pe?Pe.toStringTag:void 0;function vt(e){return e==null?e===void 0?bt:yt:ze&&ze in Object(e)?ht(e):pt(e)}i(vt,"cr");var U=vt;function gt(e){return e!=null&&typeof e=="object"}i(gt,"lr");var C=gt,mt=U,jt=C,_t="[object Symbol]";function wt(e){return typeof e=="symbol"||jt(e)&&mt(e)==_t}i(wt,"hr");var he=wt,Ot=E,At=he,xt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Et=/^\w*$/;function Ct(e,r){if(Ot(e))return!1;var t=typeof e;return t=="number"||t=="symbol"||t=="boolean"||e==null||At(e)?!0:Et.test(e)||!xt.test(e)||r!=null&&e in Object(r)}i(Ct,"vr");var Nt=Ct;function St(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}i(St,"_r");var S=St,$t=U,qt=S,Tt="[object AsyncFunction]",It="[object Function]",Pt="[object GeneratorFunction]",zt="[object Proxy]";function Rt(e){if(!qt(e))return!1;var r=$t(e);return r==It||r==Pt||r==Tt||r==zt}i(Rt,"Sr");var wr=Rt,Ut=O,Bt=Ut["__core-js_shared__"],Mt=Bt,re=Mt,Re=function(){var e=/[^.]+$/.exec(re&&re.keys&&re.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function kt(e){return!!Re&&Re in e}i(kt,"Pr");var Ft=kt,Dt=Function.prototype,Lt=Dt.toString;function Qt(e){if(e!=null){try{return Lt.call(e)}catch{}try{return e+""}catch{}}return""}i(Qt,"Rr");var Or=Qt,Wt=wr,Vt=Ft,Ht=S,Jt=Or,Gt=/[\\^$.*+?()[\]{}|]/g,Kt=/^\[object .+?Constructor\]$/,Xt=Function.prototype,Yt=Object.prototype,Zt=Xt.toString,en=Yt.hasOwnProperty,rn=RegExp("^"+Zt.call(en).replace(Gt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function tn(e){if(!Ht(e)||Vt(e))return!1;var r=Wt(e)?rn:Kt;return r.test(Jt(e))}i(tn,"Jr");var nn=tn;function an(e,r){return e==null?void 0:e[r]}i(an,"Wr");var on=an,sn=nn,cn=on;function un(e,r){var t=cn(e,r);return sn(t)?t:void 0}i(un,"kr");var N=un,ln=N,fn=ln(Object,"create"),J=fn,Ue=J;function dn(){this.__data__=Ue?Ue(null):{},this.size=0}i(dn,"ra");var hn=dn;function pn(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}i(pn,"na");var yn=pn,bn=J,vn="__lodash_hash_undefined__",gn=Object.prototype,mn=gn.hasOwnProperty;function jn(e){var r=this.__data__;if(bn){var t=r[e];return t===vn?void 0:t}return mn.call(r,e)?r[e]:void 0}i(jn,"ua");var _n=jn,wn=J,On=Object.prototype,An=On.hasOwnProperty;function xn(e){var r=this.__data__;return wn?r[e]!==void 0:An.call(r,e)}i(xn,"pa");var En=xn,Cn=J,Nn="__lodash_hash_undefined__";function Sn(e,r){var t=this.__data__;return this.size+=this.has(e)?0:1,t[e]=Cn&&r===void 0?Nn:r,this}i(Sn,"$a");var $n=Sn,qn=hn,Tn=yn,In=_n,Pn=En,zn=$n;function $(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}i($,"E");$.prototype.clear=qn;$.prototype.delete=Tn;$.prototype.get=In;$.prototype.has=Pn;$.prototype.set=zn;var Rn=$;function Un(){this.__data__=[],this.size=0}i(Un,"Sa");var Bn=Un;function Mn(e,r){return e===r||e!==e&&r!==r}i(Mn,"Ea");var pe=Mn,kn=pe;function Fn(e,r){for(var t=e.length;t--;)if(kn(e[t][0],r))return t;return-1}i(Fn,"Pa");var G=Fn,Dn=G,Ln=Array.prototype,Qn=Ln.splice;function Wn(e){var r=this.__data__,t=Dn(r,e);if(t<0)return!1;var n=r.length-1;return t==n?r.pop():Qn.call(r,t,1),--this.size,!0}i(Wn,"Ra");var Vn=Wn,Hn=G;function Jn(e){var r=this.__data__,t=Hn(r,e);return t<0?void 0:r[t][1]}i(Jn,"Fa");var Gn=Jn,Kn=G;function Xn(e){return Kn(this.__data__,e)>-1}i(Xn,"Ga");var Yn=Xn,Zn=G;function ea(e,r){var t=this.__data__,n=Zn(t,e);return n<0?(++this.size,t.push([e,r])):t[n][1]=r,this}i(ea,"qa");var ra=ea,ta=Bn,na=Vn,aa=Gn,oa=Yn,ia=ra;function q(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}i(q,"I");q.prototype.clear=ta;q.prototype.delete=na;q.prototype.get=aa;q.prototype.has=oa;q.prototype.set=ia;var K=q,sa=N,ca=O,ua=sa(ca,"Map"),ye=ua,Be=Rn,la=K,fa=ye;function da(){this.size=0,this.__data__={hash:new Be,map:new(fa||la),string:new Be}}i(da,"rn");var ha=da;function pa(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}i(pa,"nn");var ya=pa,ba=ya;function va(e,r){var t=e.__data__;return ba(r)?t[typeof r=="string"?"string":"hash"]:t.map}i(va,"cn");var X=va,ga=X;function ma(e){var r=ga(this,e).delete(e);return this.size-=r?1:0,r}i(ma,"un");var ja=ma,_a=X;function wa(e){return _a(this,e).get(e)}i(wa,"hn");var Oa=wa,Aa=X;function xa(e){return Aa(this,e).has(e)}i(xa,"yn");var Ea=xa,Ca=X;function Na(e,r){var t=Ca(this,e),n=t.size;return t.set(e,r),this.size+=t.size==n?0:1,this}i(Na,"$n");var Sa=Na,$a=ha,qa=ja,Ta=Oa,Ia=Ea,Pa=Sa;function T(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}i(T,"P");T.prototype.clear=$a;T.prototype.delete=qa;T.prototype.get=Ta;T.prototype.has=Ia;T.prototype.set=Pa;var be=T,Ar=be,za="Expected a function";function ve(e,r){if(typeof e!="function"||r!=null&&typeof r!="function")throw new TypeError(za);var t=i(function(){var n=arguments,a=r?r.apply(this,n):n[0],o=t.cache;if(o.has(a))return o.get(a);var s=e.apply(this,n);return t.cache=o.set(a,s)||o,s},"r");return t.cache=new(ve.Cache||Ar),t}i(ve,"fe");ve.Cache=Ar;var Ra=ve,Ua=Ra,Ba=500;function Ma(e){var r=Ua(e,function(n){return t.size===Ba&&t.clear(),n}),t=r.cache;return r}i(Ma,"In");var ka=Ma,Fa=ka,Da=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,La=/\\(\\)?/g,Qa=Fa(function(e){var r=[];return e.charCodeAt(0)===46&&r.push(""),e.replace(Da,function(t,n,a,o){r.push(a?o.replace(La,"$1"):n||t)}),r}),Wa=Qa;function Va(e,r){for(var t=-1,n=e==null?0:e.length,a=Array(n);++t<n;)a[t]=r(e[t],t,e);return a}i(Va,"Dn");var Ha=Va,Me=R,Ja=Ha,Ga=E,Ka=he,Xa=1/0,ke=Me?Me.prototype:void 0,Fe=ke?ke.toString:void 0;function xr(e){if(typeof e=="string")return e;if(Ga(e))return Ja(e,xr)+"";if(Ka(e))return Fe?Fe.call(e):"";var r=e+"";return r=="0"&&1/e==-Xa?"-0":r}i(xr,"pt");var Ya=xr,Za=Ya;function eo(e){return e==null?"":Za(e)}i(eo,"zn");var ro=eo,to=E,no=Nt,ao=Wa,oo=ro;function io(e,r){return to(e)?e:no(e,r)?[e]:ao(oo(e))}i(io,"Yn");var so=io,co=he,uo=1/0;function lo(e){if(typeof e=="string"||co(e))return e;var r=e+"";return r=="0"&&1/e==-uo?"-0":r}i(lo,"ts");var fo=lo,ho=so,po=fo;function yo(e,r){r=ho(r,e);for(var t=0,n=r.length;e!=null&&t<n;)e=e[po(r[t++])];return t&&t==n?e:void 0}i(yo,"ss");var bo=yo,vo=bo;function go(e,r,t){var n=e==null?void 0:vo(e,r);return n===void 0?t:n}i(go,"cs");var mo=go;const b=mr(mo);var jo=K;function _o(){this.__data__=new jo,this.size=0}i(_o,"fs");var wo=_o;function Oo(e){var r=this.__data__,t=r.delete(e);return this.size=r.size,t}i(Oo,"hs");var Ao=Oo;function xo(e){return this.__data__.get(e)}i(xo,"ps");var Eo=xo;function Co(e){return this.__data__.has(e)}i(Co,"bs");var No=Co,So=K,$o=ye,qo=be,To=200;function Io(e,r){var t=this.__data__;if(t instanceof So){var n=t.__data__;if(!$o||n.length<To-1)return n.push([e,r]),this.size=++t.size,this;t=this.__data__=new qo(n)}return t.set(e,r),this.size=t.size,this}i(Io,"ws");var Po=Io,zo=K,Ro=wo,Uo=Ao,Bo=Eo,Mo=No,ko=Po;function I(e){var r=this.__data__=new zo(e);this.size=r.size}i(I,"x");I.prototype.clear=Ro;I.prototype.delete=Uo;I.prototype.get=Bo;I.prototype.has=Mo;I.prototype.set=ko;var ge=I;function Fo(e,r){for(var t=-1,n=e==null?0:e.length;++t<n&&r(e[t],t,e)!==!1;);return e}i(Fo,"Ps");var Do=Fo,Lo=N,Qo=function(){try{var e=Lo(Object,"defineProperty");return e({},"",{}),e}catch{}}(),Wo=Qo,De=Wo;function Vo(e,r,t){r=="__proto__"&&De?De(e,r,{configurable:!0,enumerable:!0,value:t,writable:!0}):e[r]=t}i(Vo,"Ls");var Er=Vo,Ho=Er,Jo=pe,Go=Object.prototype,Ko=Go.hasOwnProperty;function Xo(e,r,t){var n=e[r];(!(Ko.call(e,r)&&Jo(n,t))||t===void 0&&!(r in e))&&Ho(e,r,t)}i(Xo,"Gs");var Cr=Xo,Yo=Cr,Zo=Er;function ei(e,r,t,n){var a=!t;t||(t={});for(var o=-1,s=r.length;++o<s;){var c=r[o],u=n?n(t[c],e[c],c,t,e):void 0;u===void 0&&(u=e[c]),a?Zo(t,c,u):Yo(t,c,u)}return t}i(ei,"qs");var Y=ei;function ri(e,r){for(var t=-1,n=Array(e);++t<e;)n[t]=r(t);return n}i(ri,"zs");var ti=ri,ni=U,ai=C,oi="[object Arguments]";function ii(e){return ai(e)&&ni(e)==oi}i(ii,"Xs");var si=ii,Le=si,ci=C,Nr=Object.prototype,ui=Nr.hasOwnProperty,li=Nr.propertyIsEnumerable,fi=Le(function(){return arguments}())?Le:function(e){return ci(e)&&ui.call(e,"callee")&&!li.call(e,"callee")},di=fi,L={exports:{}};function hi(){return!1}i(hi,"ai");var pi=hi;L.exports;(function(e,r){var t=O,n=pi,a=r&&!r.nodeType&&r,o=a&&!0&&e&&!e.nodeType&&e,s=o&&o.exports===a,c=s?t.Buffer:void 0,u=c?c.isBuffer:void 0,l=u||n;e.exports=l})(L,L.exports);var me=L.exports,yi=9007199254740991,bi=/^(?:0|[1-9]\d*)$/;function vi(e,r){var t=typeof e;return r=r??yi,!!r&&(t=="number"||t!="symbol"&&bi.test(e))&&e>-1&&e%1==0&&e<r}i(vi,"oi");var gi=vi,mi=9007199254740991;function ji(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=mi}i(ji,"ui");var Sr=ji,_i=U,wi=Sr,Oi=C,Ai="[object Arguments]",xi="[object Array]",Ei="[object Boolean]",Ci="[object Date]",Ni="[object Error]",Si="[object Function]",$i="[object Map]",qi="[object Number]",Ti="[object Object]",Ii="[object RegExp]",Pi="[object Set]",zi="[object String]",Ri="[object WeakMap]",Ui="[object ArrayBuffer]",Bi="[object DataView]",Mi="[object Float32Array]",ki="[object Float64Array]",Fi="[object Int8Array]",Di="[object Int16Array]",Li="[object Int32Array]",Qi="[object Uint8Array]",Wi="[object Uint8ClampedArray]",Vi="[object Uint16Array]",Hi="[object Uint32Array]",y={};y[Mi]=y[ki]=y[Fi]=y[Di]=y[Li]=y[Qi]=y[Wi]=y[Vi]=y[Hi]=!0;y[Ai]=y[xi]=y[Ui]=y[Ei]=y[Bi]=y[Ci]=y[Ni]=y[Si]=y[$i]=y[qi]=y[Ti]=y[Ii]=y[Pi]=y[zi]=y[Ri]=!1;function Ji(e){return Oi(e)&&wi(e.length)&&!!y[_i(e)]}i(Ji,"Fi");var Gi=Ji;function Ki(e){return function(r){return e(r)}}i(Ki,"Ui");var je=Ki,Q={exports:{}};Q.exports;(function(e,r){var t=jr,n=r&&!r.nodeType&&r,a=n&&!0&&e&&!e.nodeType&&e,o=a&&a.exports===n,s=o&&t.process,c=function(){try{var u=a&&a.require&&a.require("util").types;return u||s&&s.binding&&s.binding("util")}catch{}}();e.exports=c})(Q,Q.exports);var _e=Q.exports,Xi=Gi,Yi=je,Qe=_e,We=Qe&&Qe.isTypedArray,Zi=We?Yi(We):Xi,$r=Zi,es=ti,rs=di,ts=E,ns=me,as=gi,os=$r,is=Object.prototype,ss=is.hasOwnProperty;function cs(e,r){var t=ts(e),n=!t&&rs(e),a=!t&&!n&&ns(e),o=!t&&!n&&!a&&os(e),s=t||n||a||o,c=s?es(e.length,String):[],u=c.length;for(var l in e)(r||ss.call(e,l))&&!(s&&(l=="length"||a&&(l=="offset"||l=="parent")||o&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||as(l,u)))&&c.push(l);return c}i(cs,"Zi");var qr=cs,us=Object.prototype;function ls(e){var r=e&&e.constructor,t=typeof r=="function"&&r.prototype||us;return e===t}i(ls,"eo");var we=ls;function fs(e,r){return function(t){return e(r(t))}}i(fs,"to");var Tr=fs,ds=Tr,hs=ds(Object.keys,Object),ps=hs,ys=we,bs=ps,vs=Object.prototype,gs=vs.hasOwnProperty;function ms(e){if(!ys(e))return bs(e);var r=[];for(var t in Object(e))gs.call(e,t)&&t!="constructor"&&r.push(t);return r}i(ms,"lo");var js=ms,_s=wr,ws=Sr;function Os(e){return e!=null&&ws(e.length)&&!_s(e)}i(Os,"go");var Ir=Os,As=qr,xs=js,Es=Ir;function Cs(e){return Es(e)?As(e):xs(e)}i(Cs,"vo");var Z=Cs,Ns=Y,Ss=Z;function $s(e,r){return e&&Ns(r,Ss(r),e)}i($s,"mo");var qs=$s;function Ts(e){var r=[];if(e!=null)for(var t in Object(e))r.push(t);return r}i(Ts,"wo");var Is=Ts,Ps=S,zs=we,Rs=Is,Us=Object.prototype,Bs=Us.hasOwnProperty;function Ms(e){if(!Ps(e))return Rs(e);var r=zs(e),t=[];for(var n in e)n=="constructor"&&(r||!Bs.call(e,n))||t.push(n);return t}i(Ms,"Io");var ks=Ms,Fs=qr,Ds=ks,Ls=Ir;function Qs(e){return Ls(e)?Fs(e,!0):Ds(e)}i(Qs,"Ro");var Oe=Qs,Ws=Y,Vs=Oe;function Hs(e,r){return e&&Ws(r,Vs(r),e)}i(Hs,"Fo");var Js=Hs,W={exports:{}};W.exports;(function(e,r){var t=O,n=r&&!r.nodeType&&r,a=n&&!0&&e&&!e.nodeType&&e,o=a&&a.exports===n,s=o?t.Buffer:void 0,c=s?s.allocUnsafe:void 0;function u(l,f){if(f)return l.slice();var p=l.length,d=c?c(p):new l.constructor(p);return l.copy(d),d}i(u,"c"),e.exports=u})(W,W.exports);var Gs=W.exports;function Ks(e,r){var t=-1,n=e.length;for(r||(r=Array(n));++t<n;)r[t]=e[t];return r}i(Ks,"Go");var Xs=Ks;function Ys(e,r){for(var t=-1,n=e==null?0:e.length,a=0,o=[];++t<n;){var s=e[t];r(s,t,e)&&(o[a++]=s)}return o}i(Ys,"Ho");var Zs=Ys;function ec(){return[]}i(ec,"zo");var Pr=ec,rc=Zs,tc=Pr,nc=Object.prototype,ac=nc.propertyIsEnumerable,Ve=Object.getOwnPropertySymbols,oc=Ve?function(e){return e==null?[]:(e=Object(e),rc(Ve(e),function(r){return ac.call(e,r)}))}:tc,Ae=oc,ic=Y,sc=Ae;function cc(e,r){return ic(e,sc(e),r)}i(cc,"ko");var uc=cc;function lc(e,r){for(var t=-1,n=r.length,a=e.length;++t<n;)e[a+t]=r[t];return e}i(lc,"tc");var zr=lc,fc=Tr,dc=fc(Object.getPrototypeOf,Object),Rr=dc,hc=zr,pc=Rr,yc=Ae,bc=Pr,vc=Object.getOwnPropertySymbols,gc=vc?function(e){for(var r=[];e;)hc(r,yc(e)),e=pc(e);return r}:bc,Ur=gc,mc=Y,jc=Ur;function _c(e,r){return mc(e,jc(e),r)}i(_c,"dc");var wc=_c,Oc=zr,Ac=E;function xc(e,r,t){var n=r(e);return Ac(e)?n:Oc(n,t(e))}i(xc,"yc");var Br=xc,Ec=Br,Cc=Ae,Nc=Z;function Sc(e){return Ec(e,Nc,Cc)}i(Sc,"_c");var Mr=Sc,$c=Br,qc=Ur,Tc=Oe;function Ic(e){return $c(e,Tc,qc)}i(Ic,"Tc");var Pc=Ic,zc=N,Rc=O,Uc=zc(Rc,"DataView"),Bc=Uc,Mc=N,kc=O,Fc=Mc(kc,"Promise"),Dc=Fc,Lc=N,Qc=O,Wc=Lc(Qc,"Set"),Vc=Wc,Hc=N,Jc=O,Gc=Hc(Jc,"WeakMap"),Kc=Gc,ae=Bc,oe=ye,ie=Dc,se=Vc,ce=Kc,kr=U,P=Or,He="[object Map]",Xc="[object Object]",Je="[object Promise]",Ge="[object Set]",Ke="[object WeakMap]",Xe="[object DataView]",Yc=P(ae),Zc=P(oe),eu=P(ie),ru=P(se),tu=P(ce),x=kr;(ae&&x(new ae(new ArrayBuffer(1)))!=Xe||oe&&x(new oe)!=He||ie&&x(ie.resolve())!=Je||se&&x(new se)!=Ge||ce&&x(new ce)!=Ke)&&(x=i(function(e){var r=kr(e),t=r==Xc?e.constructor:void 0,n=t?P(t):"";if(n)switch(n){case Yc:return Xe;case Zc:return He;case eu:return Je;case ru:return Ge;case tu:return Ke}return r},"T"));var ee=x,nu=Object.prototype,au=nu.hasOwnProperty;function ou(e){var r=e.length,t=new e.constructor(r);return r&&typeof e[0]=="string"&&au.call(e,"index")&&(t.index=e.index,t.input=e.input),t}i(ou,"Xc");var iu=ou,su=O,cu=su.Uint8Array,Fr=cu,Ye=Fr;function uu(e){var r=new e.constructor(e.byteLength);return new Ye(r).set(new Ye(e)),r}i(uu,"el");var xe=uu,lu=xe;function fu(e,r){var t=r?lu(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.byteLength)}i(fu,"rl");var du=fu,hu=/\w*$/;function pu(e){var r=new e.constructor(e.source,hu.exec(e));return r.lastIndex=e.lastIndex,r}i(pu,"sl");var yu=pu,Ze=R,er=Ze?Ze.prototype:void 0,rr=er?er.valueOf:void 0;function bu(e){return rr?Object(rr.call(e)):{}}i(bu,"ol");var vu=bu,gu=xe;function mu(e,r){var t=r?gu(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.length)}i(mu,"ul");var ju=mu,_u=xe,wu=du,Ou=yu,Au=vu,xu=ju,Eu="[object Boolean]",Cu="[object Date]",Nu="[object Map]",Su="[object Number]",$u="[object RegExp]",qu="[object Set]",Tu="[object String]",Iu="[object Symbol]",Pu="[object ArrayBuffer]",zu="[object DataView]",Ru="[object Float32Array]",Uu="[object Float64Array]",Bu="[object Int8Array]",Mu="[object Int16Array]",ku="[object Int32Array]",Fu="[object Uint8Array]",Du="[object Uint8ClampedArray]",Lu="[object Uint16Array]",Qu="[object Uint32Array]";function Wu(e,r,t){var n=e.constructor;switch(r){case Pu:return _u(e);case Eu:case Cu:return new n(+e);case zu:return wu(e,t);case Ru:case Uu:case Bu:case Mu:case ku:case Fu:case Du:case Lu:case Qu:return xu(e,t);case Nu:return new n;case Su:case Tu:return new n(e);case $u:return Ou(e);case qu:return new n;case Iu:return Au(e)}}i(Wu,"Ll");var Vu=Wu,Hu=S,tr=Object.create,Ju=function(){function e(){}return i(e,"t"),function(r){if(!Hu(r))return{};if(tr)return tr(r);e.prototype=r;var t=new e;return e.prototype=void 0,t}}(),Gu=Ju,Ku=Gu,Xu=Rr,Yu=we;function Zu(e){return typeof e.constructor=="function"&&!Yu(e)?Ku(Xu(e)):{}}i(Zu,"ql");var el=Zu,rl=ee,tl=C,nl="[object Map]";function al(e){return tl(e)&&rl(e)==nl}i(al,"Wl");var ol=al,il=ol,sl=je,nr=_e,ar=nr&&nr.isMap,cl=ar?sl(ar):il,ul=cl,ll=ee,fl=C,dl="[object Set]";function hl(e){return fl(e)&&ll(e)==dl}i(hl,"nu");var pl=hl,yl=pl,bl=je,or=_e,ir=or&&or.isSet,vl=ir?bl(ir):yl,gl=vl,ml=ge,jl=Do,_l=Cr,wl=qs,Ol=Js,Al=Gs,xl=Xs,El=uc,Cl=wc,Nl=Mr,Sl=Pc,$l=ee,ql=iu,Tl=Vu,Il=el,Pl=E,zl=me,Rl=ul,Ul=S,Bl=gl,Ml=Z,kl=Oe,Fl=1,Dl=2,Ll=4,Dr="[object Arguments]",Ql="[object Array]",Wl="[object Boolean]",Vl="[object Date]",Hl="[object Error]",Lr="[object Function]",Jl="[object GeneratorFunction]",Gl="[object Map]",Kl="[object Number]",Qr="[object Object]",Xl="[object RegExp]",Yl="[object Set]",Zl="[object String]",ef="[object Symbol]",rf="[object WeakMap]",tf="[object ArrayBuffer]",nf="[object DataView]",af="[object Float32Array]",of="[object Float64Array]",sf="[object Int8Array]",cf="[object Int16Array]",uf="[object Int32Array]",lf="[object Uint8Array]",ff="[object Uint8ClampedArray]",df="[object Uint16Array]",hf="[object Uint32Array]",h={};h[Dr]=h[Ql]=h[tf]=h[nf]=h[Wl]=h[Vl]=h[af]=h[of]=h[sf]=h[cf]=h[uf]=h[Gl]=h[Kl]=h[Qr]=h[Xl]=h[Yl]=h[Zl]=h[ef]=h[lf]=h[ff]=h[df]=h[hf]=!0;h[Hl]=h[Lr]=h[rf]=!1;function D(e,r,t,n,a,o){var s,c=r&Fl,u=r&Dl,l=r&Ll;if(t&&(s=a?t(e,n,a,o):t(e)),s!==void 0)return s;if(!Ul(e))return e;var f=Pl(e);if(f){if(s=ql(e),!c)return xl(e,s)}else{var p=$l(e),d=p==Lr||p==Jl;if(zl(e))return Al(e,c);if(p==Qr||p==Dr||d&&!a){if(s=u||d?{}:Il(e),!c)return u?Cl(e,Ol(s,e)):El(e,wl(s,e))}else{if(!h[p])return a?e:{};s=Tl(e,p,c)}}o||(o=new ml);var w=o.get(e);if(w)return w;o.set(e,s),Bl(e)?e.forEach(function(g){s.add(D(g,r,t,g,e,o))}):Rl(e)&&e.forEach(function(g,m){s.set(m,D(g,r,t,m,e,o))});var j=l?u?Sl:Nl:u?kl:Ml,_=f?void 0:j(e);return jl(_||e,function(g,m){_&&(m=g,g=e[m]),_l(s,m,D(g,r,t,m,e,o))}),s}i(D,"G");var pf=D,yf="__lodash_hash_undefined__";function bf(e){return this.__data__.set(e,yf),this}i(bf,"of");var vf=bf;function gf(e){return this.__data__.has(e)}i(gf,"lf");var mf=gf,jf=be,_f=vf,wf=mf;function V(e){var r=-1,t=e==null?0:e.length;for(this.__data__=new jf;++r<t;)this.add(e[r])}i(V,"z");V.prototype.add=V.prototype.push=_f;V.prototype.has=wf;var Of=V;function Af(e,r){for(var t=-1,n=e==null?0:e.length;++t<n;)if(r(e[t],t,e))return!0;return!1}i(Af,"pf");var xf=Af;function Ef(e,r){return e.has(r)}i(Ef,"bf");var Cf=Ef,Nf=Of,Sf=xf,$f=Cf,qf=1,Tf=2;function If(e,r,t,n,a,o){var s=t&qf,c=e.length,u=r.length;if(c!=u&&!(s&&u>c))return!1;var l=o.get(e),f=o.get(r);if(l&&f)return l==r&&f==e;var p=-1,d=!0,w=t&Tf?new Nf:void 0;for(o.set(e,r),o.set(r,e);++p<c;){var j=e[p],_=r[p];if(n)var g=s?n(_,j,p,r,e,o):n(j,_,p,e,r,o);if(g!==void 0){if(g)continue;d=!1;break}if(w){if(!Sf(r,function(m,A){if(!$f(w,A)&&(j===m||a(j,m,t,n,o)))return w.push(A)})){d=!1;break}}else if(!(j===_||a(j,_,t,n,o))){d=!1;break}}return o.delete(e),o.delete(r),d}i(If,"Tf");var Wr=If;function Pf(e){var r=-1,t=Array(e.size);return e.forEach(function(n,a){t[++r]=[a,n]}),t}i(Pf,"Of");var zf=Pf;function Rf(e){var r=-1,t=Array(e.size);return e.forEach(function(n){t[++r]=n}),t}i(Rf,"Sf");var Uf=Rf,sr=R,cr=Fr,Bf=pe,Mf=Wr,kf=zf,Ff=Uf,Df=1,Lf=2,Qf="[object Boolean]",Wf="[object Date]",Vf="[object Error]",Hf="[object Map]",Jf="[object Number]",Gf="[object RegExp]",Kf="[object Set]",Xf="[object String]",Yf="[object Symbol]",Zf="[object ArrayBuffer]",ed="[object DataView]",ur=sr?sr.prototype:void 0,te=ur?ur.valueOf:void 0;function rd(e,r,t,n,a,o,s){switch(t){case ed:if(e.byteLength!=r.byteLength||e.byteOffset!=r.byteOffset)return!1;e=e.buffer,r=r.buffer;case Zf:return!(e.byteLength!=r.byteLength||!o(new cr(e),new cr(r)));case Qf:case Wf:case Jf:return Bf(+e,+r);case Vf:return e.name==r.name&&e.message==r.message;case Gf:case Xf:return e==r+"";case Hf:var c=kf;case Kf:var u=n&Df;if(c||(c=Ff),e.size!=r.size&&!u)return!1;var l=s.get(e);if(l)return l==r;n|=Lf,s.set(e,r);var f=Mf(c(e),c(r),n,a,o,s);return s.delete(e),f;case Yf:if(te)return te.call(e)==te.call(r)}return!1}i(rd,"Vf");var td=rd,lr=Mr,nd=1,ad=Object.prototype,od=ad.hasOwnProperty;function id(e,r,t,n,a,o){var s=t&nd,c=lr(e),u=c.length,l=lr(r),f=l.length;if(u!=f&&!s)return!1;for(var p=u;p--;){var d=c[p];if(!(s?d in r:od.call(r,d)))return!1}var w=o.get(e),j=o.get(r);if(w&&j)return w==r&&j==e;var _=!0;o.set(e,r),o.set(r,e);for(var g=s;++p<u;){d=c[p];var m=e[d],A=r[d];if(n)var qe=s?n(A,m,d,r,e,o):n(m,A,d,e,r,o);if(!(qe===void 0?m===A||a(m,A,t,n,o):qe)){_=!1;break}g||(g=d=="constructor")}if(_&&!g){var B=e.constructor,M=r.constructor;B!=M&&"constructor"in e&&"constructor"in r&&!(typeof B=="function"&&B instanceof B&&typeof M=="function"&&M instanceof M)&&(_=!1)}return o.delete(e),o.delete(r),_}i(id,"Yf");var sd=id,ne=ge,cd=Wr,ud=td,ld=sd,fr=ee,dr=E,hr=me,fd=$r,dd=1,pr="[object Arguments]",yr="[object Array]",F="[object Object]",hd=Object.prototype,br=hd.hasOwnProperty;function pd(e,r,t,n,a,o){var s=dr(e),c=dr(r),u=s?yr:fr(e),l=c?yr:fr(r);u=u==pr?F:u,l=l==pr?F:l;var f=u==F,p=l==F,d=u==l;if(d&&hr(e)){if(!hr(r))return!1;s=!0,f=!1}if(d&&!f)return o||(o=new ne),s||fd(e)?cd(e,r,t,n,a,o):ud(e,r,u,t,n,a,o);if(!(t&dd)){var w=f&&br.call(e,"__wrapped__"),j=p&&br.call(r,"__wrapped__");if(w||j){var _=w?e.value():e,g=j?r.value():r;return o||(o=new ne),a(_,g,t,n,o)}}return d?(o||(o=new ne),ld(e,r,t,n,a,o)):!1}i(pd,"sd");var yd=pd,bd=yd,vr=C;function Vr(e,r,t,n,a){return e===r?!0:e==null||r==null||!vr(e)&&!vr(r)?e!==e&&r!==r:bd(e,r,t,n,Vr,a)}i(Vr,"Lt");var vd=Vr,gd=ge,md=vd,jd=1,_d=2;function wd(e,r,t,n){var a=t.length,o=a,s=!n;if(e==null)return!o;for(e=Object(e);a--;){var c=t[a];if(s&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++a<o;){c=t[a];var u=c[0],l=e[u],f=c[1];if(s&&c[2]){if(l===void 0&&!(u in e))return!1}else{var p=new gd;if(n)var d=n(l,f,u,e,r,p);if(!(d===void 0?md(f,l,jd|_d,n,p):d))return!1}}return!0}i(wd,"hd");var Od=wd,Ad=S;function xd(e){return e===e&&!Ad(e)}i(xd,"yd");var Ed=xd,Cd=Ed,Nd=Z;function Sd(e){for(var r=Nd(e),t=r.length;t--;){var n=r[t],a=e[n];r[t]=[n,a,Cd(a)]}return r}i(Sd,"_d");var $d=Sd;function qd(e,r){return function(t){return t==null?!1:t[e]===r&&(r!==void 0||e in Object(t))}}i(qd,"Ad");var Td=qd,Id=Od,Pd=$d,zd=Td;function Rd(e){var r=Pd(e);return r.length==1&&r[0][2]?zd(r[0][0],r[0][1]):function(t){return t===e||Id(t,e,r)}}i(Rd,"Sd");var Ud=Rd,Bd=pf,Md=Ud,kd=1;function Fd(e){return Md(Bd(e,kd))}i(Fd,"xd");var Dd=Fd;const Ld=mr(Dd),Ee=class Ee{constructor({items:r=[],identifierName:t="id",getNewId:n}={}){if(v(this,"sequence",0),v(this,"items",[]),v(this,"database",null),v(this,"name",null),v(this,"identifierName","id"),v(this,"getNewId"),!Array.isArray(r))throw new Error("Can't initialize a Collection with anything else than an array of items");this.identifierName=t,this.getNewId=n||this.getNewIdFromSequence,r.map(this.addOne.bind(this))}setDatabase(r){this.database=r}setName(r){this.name=r}_oneToManyEmbedder(r){if(this.name==null)throw new Error("Can't embed references without a collection name");const t=`${this.name.slice(0,-1)}_id`;return n=>{if(this.database==null)throw new Error("Can't embed references without a database");const a=this.database.collections[r];if(!a)throw new Error(`Can't embed a non-existing collection ${r}`);return Array.isArray(n[r])?n[r]=a.getAll({filter:i(o=>n[r].indexOf(o[a.identifierName])!==-1,"filter")}):n[r]=a.getAll({filter:i(o=>o[t]===n[this.identifierName],"filter")}),n}}_manyToOneEmbedder(r){const t=`${r}s`,n=`${r}_id`;return a=>{if(this.database==null)throw new Error("Can't embed references without a database");const o=this.database.collections[t];if(!o)throw new Error(`Can't embed a non-existing collection ${r}`);try{a[r]=o.getOne(a[n])}catch{}return a}}_itemEmbedder(r){const t=(Array.isArray(r)?r:[r]).map(n=>n.endsWith("s")?this._oneToManyEmbedder(n):this._manyToOneEmbedder(n));return n=>t.reduce((a,o)=>o(a),n)}getCount(r){return this.getAll(r).length}getAll(r){let t=this.items.slice(0);return r&&(r.filter&&(t=Hr(t,r.filter)),r.sort&&(t=Hd(t,r.sort)),r.range&&(t=Jd(t,r.range)),t=t.map(n=>Object.assign({},n)),r.embed&&this.database&&(t=t.map(this._itemEmbedder(r.embed)))),t}getIndex(r){return this.items.findIndex(t=>t[this.identifierName]==r)}getOne(r,t){const n=this.getIndex(r);if(n===-1)throw new Error(`No item with identifier ${r}`);let a=this.items[n];return a=Object.assign({},a),t!=null&&t.embed&&this.database&&(a=this._itemEmbedder(t.embed)(a)),a}getNewIdFromSequence(){return this.sequence++}addOne(r){const t=r[this.identifierName];if(t!=null){if(this.getIndex(t)!==-1)throw new Error(`An item with the identifier ${t} already exists`);typeof t=="number"&&(this.sequence=Math.max(this.sequence,t)+1)}else r[this.identifierName]=this.getNewId();return this.items.push(r),Object.assign({},r)}updateOne(r,t){const n=this.getIndex(r);if(n===-1)throw new Error(`No item with identifier ${r}`);for(const a in t)this.items[n][a]=t[a];return Object.assign({},this.items[n])}removeOne(r){const t=this.getIndex(r);if(t===-1)throw new Error(`No item with identifier ${r}`);const n=this.items[t];return this.items.splice(t,1),typeof r=="number"&&r==this.sequence-1&&this.sequence--,n}};i(Ee,"ot");let H=Ee;const Qd=i((e,r)=>e.reduce((t,n)=>t&&r(n),!0),"Rd"),Wd=i((e,r)=>e.reduce((t,n)=>t||r(n),!1),"Ld"),Vd=i((e,r)=>e.reduce((t,n,a)=>{if(t!=null)return t;const o=e.slice(0,a+1).join("."),s=e.slice(a+1).join("."),c=b(r,o);return Array.isArray(c)&&a<e.length-1?[o,s]:void 0},void 0),"Dd"),gr=i((e,r)=>{if(e.indexOf("_q")!==-1){const t=e.replace(/(_q)$/,""),n=new RegExp(r.toString(),"i");return a=>{var o;return((o=b(a,t))==null?void 0:o.toString().match(n))!==null}}if(e.indexOf("_lte")!==-1){const t=e.replace(/(_lte)$/,"");return n=>b(n,t)<=r}if(e.indexOf("_gte")!==-1){const t=e.replace(/(_gte)$/,"");return n=>b(n,t)>=r}if(e.indexOf("_lt")!==-1){const t=e.replace(/(_lt)$/,"");return n=>b(n,t)<r}if(e.indexOf("_gt")!==-1){const t=e.replace(/(_gt)$/,"");return n=>b(n,t)>r}if(e.indexOf("_neq_any")!==-1){const t=e.replace(/(_neq_any)$/,""),n=Array.isArray(r)?r:[r];return a=>n.every(o=>b(a,t)!=o)}if(e.indexOf("_neq")!==-1){const t=e.replace(/(_neq)$/,"");return n=>b(n,t)!=r}if(e.indexOf("_eq_any")!==-1){const t=e.replace(/(_eq_any)$/,""),n=Array.isArray(r)?r:[r];return a=>n.some(o=>b(a,t)==o)}if(e.indexOf("_eq")!==-1){const t=e.replace(/(_eq)$/,"");return n=>b(n,t)==r}if(e.indexOf("_inc_any")!==-1){const t=e.replace(/(_inc_any)$/,""),n=Array.isArray(r)?r:[r];return a=>n.some(o=>{const s=b(a,t);return Array.isArray(s)||typeof s=="string"?s.includes(o):!1})}if(e.indexOf("_inc")!==-1){const t=e.replace(/(_inc)$/,""),n=Array.isArray(r)?r:[r];return a=>n.every(o=>{const s=b(a,t);return Array.isArray(s)||typeof s=="string"?s.includes(o):!1})}if(e.indexOf("_ninc_any")!==-1){const t=e.replace(/(_ninc_any)$/,""),n=Array.isArray(r)?r:[r];return a=>n.every(o=>{const s=b(a,t);return Array.isArray(s)||typeof s=="string"?!s.includes(o):!1})}return Array.isArray(r)?t=>Array.isArray(b(t,e))?Qd(r,n=>{const a=b(t,e);return Array.isArray(a)?Wd(a,o=>o==n):!1}):r.filter(n=>n==b(t,e)).length>0:typeof r=="object"?t=>Ld(r)(b(t,e)):t=>{const n=b(t,e);return Array.isArray(n)&&typeof r=="string"?n.indexOf(r)!==-1:typeof n=="boolean"&&typeof r=="string"?n===(r==="true"):n==r}},"ct");function Hr(e,r){if(typeof r=="function")return e.filter(r);if(r instanceof Object){const t=Object.keys(r).map(n=>{if(n==="q"&&typeof r.q=="string"){const s=new RegExp(r.q,"i"),c=i(u=>{for(const l in u){const f=u[l];if(typeof f=="object"&&c(f)||f&&typeof f=="string"&&f.match&&f.match(s)!==null)return!0}return!1},"o");return c}const a=n.split("."),o=r[n];return a.length>1?s=>{const c=Vd(a,s);if(c){const[u,l]=c,f=b(s,u);return Array.isArray(f)?Hr(f,{[l]:o}).length>0:!1}return gr(n,o)(s)}:gr(n,o)});return e.filter(n=>t.reduce((a,o)=>a&&o(n),!0))}throw new Error("Unsupported filter type")}i(Hr,"Dt");function Hd(e,r){if(typeof r=="function")return e.sort(r);if(typeof r=="string")return e.sort((t,n)=>t[r]>n[r]?1:t[r]<n[r]?-1:0);if(Array.isArray(r)){const t=r[0],n=r[1].toLowerCase()==="asc"?1:-1;return e.sort((a,o)=>a[t]>o[t]?n:a[t]<o[t]?-1*n:0)}throw new Error("Unsupported sort type")}i(Hd,"Fd");function Jd(e,r){if(Array.isArray(r))return e.slice(r[0],r[1]!==void 0?r[1]+1:void 0);throw new Error("Unsupported range type")}i(Jd,"Bd");const Ce=class Ce{constructor(r){if(v(this,"obj",null),v(this,"database",null),v(this,"name",null),!(r instanceof Object))throw new Error("Can't initialize a Single with anything except an object");this.obj=r}setDatabase(r){this.database=r}setName(r){this.name=r}_oneToManyEmbedder(r){return t=>{if(this.database==null)throw new Error("Can't embed references without a database");const n=this.database.collections[r];if(!n)throw new Error(`Can't embed a non-existing collection ${r}`);return t[r]=n.getAll({filter:i(a=>t[r].indexOf(a[n.identifierName])!==-1,"filter")}),t}}_manyToOneEmbedder(r){const t=`${r}s`,n=`${r}_id`;return a=>{if(this.database==null)throw new Error("Can't embed references without a database");const o=this.database.collections[t];if(!o)throw new Error(`Can't embed a non-existing collection ${r}`);try{a[r]=o.getOne(a[n])}catch{}return a}}_itemEmbedder(r){const t=(Array.isArray(r)?r:[r]).map(n=>n.endsWith("s")?this._oneToManyEmbedder(n):this._manyToOneEmbedder(n));return n=>t.reduce((a,o)=>o(a),n)}getOnly(r){let t=this.obj;return r!=null&&r.embed&&this.database&&(t=Object.assign({},t),t=this._itemEmbedder(r.embed)(t)),t}updateOnly(r){if(this.obj==null)throw new Error("Can't update a non-existing object");for(const t in r)this.obj[t]=r[t];return this.obj}};i(Ce,"Ud");let ue=Ce;const Ne=class Ne{constructor({data:r,identifierName:t="id",getNewId:n}={}){v(this,"identifierName","id"),v(this,"collections",{}),v(this,"singles",{}),v(this,"getNewId"),this.getNewId=n,this.identifierName=t,r&&this.init(r)}init(r){for(const t in r){const n=r[t];Array.isArray(n)?this.addCollection(t,new H({items:n,identifierName:this.identifierName,getNewId:this.getNewId})):this.addSingle(t,new ue(n))}}addCollection(r,t){this.collections[r]=t,t.setDatabase(this),t.setName(r)}getCollection(r){return this.collections[r]}getCollectionNames(){return Object.keys(this.collections)}addSingle(r,t){this.singles[r]=t,t.setDatabase(this),t.setName(r)}getSingle(r){return this.singles[r]}getSingleNames(){return Object.keys(this.singles)}getCount(r,t){return this.collections[r].getCount(t)}getAll(r,t){return this.collections[r].getAll(t)}getOne(r,t,n){return this.collections[r].getOne(t,n)}addOne(r,t){return Object.prototype.hasOwnProperty.call(this.collections,r)||this.addCollection(r,new H({items:[],identifierName:this.identifierName,getNewId:this.getNewId})),this.collections[r].addOne(t)}updateOne(r,t,n){return this.collections[r].updateOne(t,n)}removeOne(r,t){return this.collections[r].removeOne(t)}getOnly(r,t){return this.singles[r].getOnly()}updateOnly(r,t){return this.singles[r].updateOnly(t)}};i(Ne,"Gd");let le=Ne;const Se=class Se{constructor({baseUrl:r="",defaultQuery:t=i(()=>({}),"r"),database:n,middlewares:a,...o}={}){v(this,"baseUrl",""),v(this,"defaultQuery",()=>({})),v(this,"middlewares"),v(this,"database"),this.baseUrl=r,this.defaultQuery=t,this.middlewares=a||[],n?this.database=n:this.database=new le(o)}setDefaultQuery(r){this.defaultQuery=r}getContext(r){var t,n;for(const o of this.database.getSingleNames())if((t=r.url)!=null&&t.match(new RegExp(`^${this.baseUrl}\\/(${o})(\\/?.*)?$`)))return{...r,single:o};const a=(n=r.url)==null?void 0:n.match(new RegExp(`^${this.baseUrl}\\/([^\\/?]+)(\\/(\\w+|\\d+))?(\\?.*)?$`));if(a){const o=a[1],s=Object.assign({},this.defaultQuery(o),r.params);return{...r,collection:o,params:s}}return r}async handle(r){const t=this.getContext(r);let n=0;const a=[...this.middlewares],o=i(s=>{const c=a[n++];return c?c(s,o):this.handleRequest(s)},"s");try{return await o(t)}catch(s){if(s instanceof Error)throw s;return s}}handleRequest(r){var t,n;for(const c of this.database.getSingleNames())if((t=r.url)!=null&&t.match(new RegExp(`^${this.baseUrl}\\/(${c})(\\/?.*)?$`))){if(r.method==="GET")try{return{status:200,body:this.database.getOnly(c),headers:{"Content-Type":"application/json"}}}catch{return{status:404,headers:{}}}if(r.method==="PUT")try{return r.requestBody==null?{status:400,headers:{}}:{status:200,body:this.database.updateOnly(c,r.requestBody),headers:{"Content-Type":"application/json"}}}catch{return{status:404,headers:{}}}if(r.method==="PATCH")try{return r.requestBody==null?{status:400,headers:{}}:{status:200,body:this.database.updateOnly(c,r.requestBody),headers:{"Content-Type":"application/json"}}}catch{return{status:404,headers:{}}}}const a=(n=r.url)==null?void 0:n.match(new RegExp(`^${this.baseUrl}\\/([^\\/?]+)(\\/(\\w+|\\d+))?(\\?.*)?$`));if(!a)return{status:404,headers:{}};const o=a[1],s=Object.assign({},this.defaultQuery(o),r.params);if(a[2]){if(!this.database.getCollection(o))return{status:404,headers:{}};const c=a[3];if(r.method==="GET")try{return{status:200,body:this.database.getOne(o,c,s),headers:{"Content-Type":"application/json"}}}catch{return{status:404,headers:{}}}if(r.method==="PUT")try{return r.requestBody==null?{status:400,headers:{}}:{status:200,body:this.database.updateOne(o,c,r.requestBody),headers:{"Content-Type":"application/json"}}}catch{return{status:404,headers:{}}}if(r.method==="PATCH")try{return r.requestBody==null?{status:400,headers:{}}:{status:200,body:this.database.updateOne(o,c,r.requestBody),headers:{"Content-Type":"application/json"}}}catch{return{status:404,headers:{}}}if(r.method==="DELETE")try{return{status:200,body:this.database.removeOne(o,c),headers:{"Content-Type":"application/json"}}}catch{return{status:404,headers:{}}}}else{if(r.method==="GET"){if(!this.database.getCollection(o))return{status:404,headers:{}};const c=this.database.getCount(o,s.filter?{filter:s.filter}:{});if(c>0){const u=this.database.getAll(o,s),l=s.range?s.range[0]:0,f=s.range&&s.range.length===2?Math.min(u.length-1+l,s.range[1]):u.length-1;return{status:u.length===c?200:206,body:u,headers:{"Content-Type":"application/json","Content-Range":`items ${l}-${f}/${c}`}}}return{status:200,body:[],headers:{"Content-Type":"application/json","Content-Range":"items */0"}}}if(r.method==="POST"){if(r.requestBody==null)return{status:400,headers:{}};const c=this.database.addOne(o,r.requestBody),u=`${this.baseUrl}/${o}/${c[this.database.getCollection(o).identifierName]}`;return{status:201,body:c,headers:{"Content-Type":"application/json",Location:u}}}}return{status:404,headers:{}}}addMiddleware(r){this.middlewares.push(r)}addCollection(r,t){this.database.addCollection(r,t)}getCollection(r){return this.database.getCollection(r)}getCollectionNames(){return this.database.getCollectionNames()}addSingle(r,t){this.database.addSingle(r,t)}getSingle(r){return this.database.getSingle(r)}getSingleNames(){return this.database.getSingleNames()}};i(Se,"_e");let fe=Se;function Gd(e){if(!e)return{};const r={};return e.split("&").map(t=>{if(t.indexOf("=")===-1)r[t]=!0;else{let[n,a]=t.split("=");(a.indexOf("[")===0||a.indexOf("{")===0)&&(a=JSON.parse(a)),r[n.trim()]=a}}),r}i(Gd,"Ft");const $e=class $e{constructor({loggingEnabled:r=!1,server:t,...n}={}){v(this,"loggingEnabled",!1),v(this,"server"),this.server=t||new fe(n),this.loggingEnabled=r}getHandler(){return async(r,t)=>{const n=new Request(r,t),a=await this.getNormalizedRequest(n),o=await this.server.handle(a);return this.log(n,o,a),o}}async getNormalizedRequest(r){const t=typeof r=="string"?new Request(r):r,n=t.url?decodeURIComponent(t.url.slice(t.url.indexOf("?")+1)):"",a=Gd(n),o=await t.text();let s;try{s=JSON.parse(o)}catch{}return{url:t.url,headers:t.headers,params:a,requestBody:s,method:t.method}}log(r,t,n){this.loggingEnabled&&(console.group?(console.groupCollapsed(n.method,n.url,"(FakeRest)"),console.group("request"),console.log(n.method,n.url),console.log("headers",r.headers),console.log("body   ",r.requestJson),console.groupEnd(),console.group("response",t.status),console.log("headers",t.headers),console.log("body   ",t.body),console.groupEnd(),console.groupEnd()):(console.log("FakeRest request ",n.method,n.url,"headers",r.headers,"body",r.requestJson),console.log("FakeRest response",t.status,"headers",t.headers,"body",t.body)))}toggleLogging(){this.loggingEnabled=!this.loggingEnabled}};i($e,"Ut");let de=$e;const Kd=i(e=>(r,t)=>new Promise(n=>{setTimeout(()=>{n(t(r))},e)}),"Wd"),eh=i(()=>{const e=Gr(),r=new de({baseUrl:"http://localhost:4000",data:e,loggingEnabled:!0,middlewares:[Kd(500)]});return window&&(window.restServer=r.server),Te.mock("begin:http://localhost:4000",r.getHandler()),()=>Te.restore()},"rest");export{eh as default};
//# sourceMappingURL=rest-Da7D-0Gs.js.map
